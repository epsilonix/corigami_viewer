<div id="plots-container"
     data-screening="{{ 'true' if screening_mode else 'false' }}"
     style="width: 100%; overflow-x: auto;">
  


  <div id="hi_c_chart"></div>
  <div id="custom_axis_hic"></div>

  <div class="atac_title_container">
    <div class="atac_title">
      <span class="atac-square"></span>
      ATAC signal
    </div>
  </div>
  <div id="atac_chart"></div>
  <div id="custom_axis_atac"></div>
  
  <div class="ctcf_title_container">
    <div class="ctcf_title">
      <span class="ctcf-square"></span>
      CTCF signal
    </div>
  </div>
  <div id="ctcf_chart"></div>
  <div id="custom_axis_ctcf"></div>
  {% if screening_mode %}
    <div class="screening_title_container">
      <div class="screening_title">
        <span class="screening-square"></span>Impact score
      </div>
    </div>
    <div id="screening_chart"></div>
    <div id="custom_axis_screening"></div>
  {% endif %}
  <div id="gene-track-wrapper" style="overflow-y: hidden;"> 
    <div id="gene_track_chart"></div>
  </div>
</div>

<!-- Ensure D3.js and d3_plots.js are loaded -->
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="{{ url_for('static', filename='d3_plots.js') }}"></script>

<script>
  // Render the main charts using the configs from the Flask context
  var hiCConfig = {{ hi_c_config|safe }};
  var ctcfConfig = {{ ctcf_config|safe }};
  var atacConfig = {{ atac_config|safe }};
  var geneTrackConfig = {{ gene_track_config|safe }};
  var customAxisConfig = {{ custom_axis_config|safe }};
  drawHiCChart('#hi_c_chart', hiCConfig);
  drawColumnChart('#ctcf_chart', ctcfConfig);
  drawColumnChart('#atac_chart', atacConfig);
  drawGeneTrackChart('#gene_track_chart', geneTrackConfig);
  drawCustomAxis('#custom_axis_hic', customAxisConfig);
  drawCustomAxis('#custom_axis_atac', customAxisConfig);
  drawCustomAxis('#custom_axis_ctcf', customAxisConfig);
  // If we have a screening config, draw it
  {% if screening_mode and screening_config %}
    var screeningConfig = {{ screening_config|safe }};
    drawColumnChart('#screening_chart', screeningConfig);
    drawCustomAxis('#custom_axis_screening', customAxisConfig);
  {% endif %}


</script>


{% if screening_mode %}
  <!-- Hidden div carrying the screening parameters from the server -->
  <div id="screening-params"
       data-screening='{{ screening_params|safe }}'
       style="display:none;">
  </div>

  <script>
    window.screening_mode = true;
    window.screening_params = JSON.parse(
      document.getElementById('screening-params').getAttribute('data-screening')
    );
  </script>

{% else %}
  <script>
    window.screening_mode = false;
  </script>
{% endif %}
